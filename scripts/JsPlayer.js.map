{"version":3,"sources":["../GenSound/JsPlayer.fs"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AAAA;;AAAA;AAAA;;;;;;;;;;;;;;;AAwBQ;AACI;AAAA;AAAA,0BAjBU,CAAE,kBAAD,eAAD,gBAiBV,GAC0B,0BAD1B;AAAK,SAAL;;AAG4B,wCAAU;AAAA;AAAA,SAAV,KAAf,mBAAQ;AAAA;AAAA,SAAR,QAAe;;AACL,4BAAS;AAAA;AAAA,SAAT;;AAAA,4JAC3B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAD0B;AAAA;AAC1B,2BAAU,SAAV,OAA0B,qBAA1B;AAAA,4BACW,SADX,EACuB,SAAS,sBAAT,CADvB;AAC+C;AAPhC;;;;AAxBvB,gCAsCe;AAAA;AAAA,KAFH,CACG,mBAAS;AAAA;AAAA,KAAT,uBADH,CApCZ;;;;mBA0CI;AAAA;AACA;AAAoB","file":"JsPlayer.js","sourceRoot":"C:/Users/exyi/Source/Repos/GenSound/scripts","sourcesContent":["ï»¿module JsPlayer\r\nopen GenSoundCore\r\nopen Fable.Core\r\nopen Fable.Core.JsInterop\r\n\r\n[<Emit(\"window.setTimeout($1, $0)\")>]\r\nlet setTimeout time callback = System.Threading.Tasks.Task.Delay(System.TimeSpan.FromMilliseconds(time)).ContinueWith(fun x -> callback()) |> ignore\r\n\r\ntype SynthInfo = { name: string }\r\n[<Emit(\"MIDI.loadPlugin({instrument: $0, onsuccess: $1})\")>]\r\nlet init instrument callback = ()\r\n\r\n[<Emit(\"MIDI.noteOn($0, $1, $2, $3)\")>]\r\nlet noteOn (channel:int) (note:int) (volume:int) (delay:float)  =\r\n    ()\r\n\r\n[<Emit(\"MIDI.noteOff($0, $1, $2)\")>]\r\nlet noteOff (channel:int) (note:int) (delay:float)  =\r\n    ()\r\n\r\n[<Emit(\"console.log($0)\")>]\r\nlet log (string:obj) = ()\r\n\r\nlet playStream notes speed =\r\n    let convertNote num =\r\n        let names = [|\"C\"; \"C#\"; \"D\"; \"D#\"; \"E\"; \"F\"; \"F#\"; \"G\"; \"G#\"; \"A\"; \"A#\"; \"B\"|]\r\n        (names.[num %% names.Length], num / names.Length + 3)\r\n\r\n    let times = notes |> Seq.map fst |> Seq.scan (+) 1.\r\n    for (time, (length, note)) in (notes |> Seq.zip times) do\r\n        noteOn 0 (note + 48) 128 (speed * time)\r\n        noteOff 0 (note + 48) (speed * (time + length))\r\n \r\n\r\nlog melody\r\n\r\nlet notes = melody \r\n            |> Seq.map (convertTone cMinor)\r\n            |> Seq.zip rythm\r\n\r\n\r\ninit \"acoustic_grand_piano\" (fun () -> \r\n    log \"piano loaded\"\r\n    playStream notes 2.0\r\n    )\r\n\r\n\r\n"]}